- name: Run workflow to filter samples
  command: nextflow run main.nf -profile test_sample_filters,mamba --outdir results
  tags:
    - sample_filters
  files:
    - path: results/sample_filtering/vcftools/keep/NC_030835.1_filt_samples.vcf.gz
      md5sum: 345943a67406af7e4806e97aed55fdc8
    - path: results/sample_filtering/vcftools/keep/NC_030836.1_filt_samples.vcf.gz
      md5sum: 1554ca15ca2dab790a2ff36cb0723c36
    - path: results/tabix/NC_030835.1_filt_samples.vcf.gz.tbi
      md5sum: 3d3b9ae62a0bad30883e348d3fc1621f
    - path: results/tabix/NC_030836.1_filt_samples.vcf.gz.tbi
      md5sum: 1896cb71da30f606917d00a6195158d5
    - path: results/gawk/prepare_new_map/scalepopgen_new_sample_pop.map
      md5sum: 70d01c1c7d52bd2e5d3727f8536a3244

- name: Run workflow to filter snps
  command: nextflow run main.nf -profile test_snp_filters,mamba --outdir results
  tags:
    - snp_filters
  files:
    - path: results/snp_filtering/vcftools/sites_filtes/28_filt_samples_filt_sites.vcf.gz
      md5sum: 837ec4362b0b5ede5fe4d7b6e0a653f7
    - path: results/snp_filtering/vcftools/sites_filtes/29_filt_samples_filt_sites.vcf.gz
      md5sum: bdc8463af5653d716d98d00a45a68349
    - path: results/tabix/28_filt_samples_filt_sites.vcf.gz.tbi
      md5sum: 0fa1008c4f9b1b5304089916dbc2899b
    - path: results/tabix/29_filt_samples_filt_sites.vcf.gz.tbi
      md5sum: 08f5ae4334b0210fe42a14af1b04c073

- name: Entire filtering workflow
  command: nextflow run main.nf -profile test_sample_snp_filters,mamba --outdir results
  tags:
    - sample_snp_filters
  files:
    - path: results/snp_filtering/vcftools/sites_filtes/NC_030835.1_filt_sites.vcf.gz
      md5sum: fdf3ddc70fcb2c6823705457abcce361
    - path: results/snp_filtering/vcftools/sites_filtes/NC_030836.1_filt_sites.vcf.gz
      md5sum: 8b5e2fb3f9abc69fcfb9d6b503939ebc
    - path: results/tabix/NC_030835.1_filt_sites.vcf.gz.tbi
      md5sum: 9b8871f940f04270e1c888f13e0b232e
    - path: results/tabix/NC_030836.1_filt_sites.vcf.gz.tbi
      md5sum: 34fdec468ea9f1546326a2d2f19f795a
    - path: results/gawk/prepare_new_map/scalepopgen_new_sample_pop.map
      md5sum: ef1e0896931aa0031f7e5bc16512e326

- name: filtering and summary stats
  command: nextflow run main.nf -profile test_filters_summary_stats,mamba --outdir results
  tags:
    - filter_stats
  files:
    - path: results/plink2/NC_030835.1.bed
      md5sum: 82645f22f37527b104ad465bf94eec8d
    - path: results/plink2/NC_030835.1.bim
      md5sum: 24f40b673b1b277a9cfedc3a86016bfb
    - path: results/plink2/NC_030835.1.fam
      md5sum: 19a231f545ecf193cddfcf5ccdeafd16
    - path: results/plink2/NC_030836.1.bed
      md5sum: fb6f38b1cbc9355399de3cfbd0b9bf09
    - path: results/plink2/NC_030836.1.bim
      md5sum: 74c17e2e5fca3b27e0bbeed951e4c125
    - path: results/plink2/NC_030836.1.fam
      md5sum: 19a231f545ecf193cddfcf5ccdeafd16
    - path: results/plink2/scalepopgen.bed
      md5sum: 8c97f8a8c953bfb288db6c99a4599608
    - path: results/plink2/scalepopgen.bim
      md5sum: 353b8b260e414884a812403359fb0d8a
    - path: results/plink2/scalepopgen.fam
      md5sum: 971f08e975dee80137465ae67f11e46d
    - path: results/summary_stats/plink2/sample_counts/scalepopgen_sample_summary.scount
      md5sum: c8aa0926fe3440ef047efa349b6db353
    # md5sum alters due to merging procedure of bokeh generated htmls
    - path: results/summary_stats/python/plot/sample_stats/scalepopgen_samplewise_snp_counts_mqc.html
    - path: results/gawk/make_cluster_file/scalepopgen.cluster
      md5sum: d93f97b1e08ed55dbd89abe6a24002af
    - path: results/summary_stats/plink/calc_maf_hardy/scalepopgen.frq.strat
      md5sum: d86cbf775aeff4ffef212a1db0e3ec0b
    - path: results/summary_stats/python/plot/average_maf/scalepopgen_maf_summary_mqc.html
    - path: results/summary_stats/python/plot/average_maf/populationwise_maf_report.txt
      md5sum: ef5268619e0fe0b4e8469664abd6ce19
    - path: results/summary_stats/python/plot/average_het/scalepopgen_exp_het_mqc.html
    - path: results/summary_stats/python/plot/average_het/scalepopgen_obs_het_mqc.html
    # md5sum alters due to random channel inputs 
    - path: results/summary_stats/python/plot/average_het/populationwise_heterozygosity_report.txt

- name: filtering and pca
  command: nextflow run scalepopgen_v1/ -profile test_filters_summary_pca,mamba --outdir results
  tags:
    - test_filters_summary_pca
  files:
    - path: results/plink2/remove_custom_indi_genetic_structure/scalepopgen_rem_indi.bed
      md5sum: 97d1567782500859080e7ba4b7f68d27
    - path: results/plink2/remove_custom_indi_genetic_structure/scalepopgen_rem_indi.bim
      md5sum: 353b8b260e414884a812403359fb0d8a
    - path: results/plink2/remove_custom_indi_genetic_structure/scalepopgen_rem_indi.fam
      md5sum: d9f491f30824a8298ca82a4d7efae3ea
    - path: results/plink2/remove_custom_indi_genetic_structure/scalepopgen_rem_indi_ld_filtered.bed
      md5sum: cbce975dbc7c713efa9d18918f0fc3cc
    - path: results/plink2/remove_custom_indi_genetic_structure/scalepopgen_rem_indi_ld_filtered.bim
      md5sum: 1419e667ac64fbfea3bb1b8f21148625
    - path: results/plink2/remove_custom_indi_genetic_structure/scalepopgen_rem_indi_ld_filtered.fam
      md5sum: d9f491f30824a8298ca82a4d7efae3ea
    - path: results/plink/make_bed/scalepopgen_rem_indi_ld_filtered_update_chrom_id.bed
      md5sum: 5df960c69cf9404ee88a539021c9604c
    - path: results/plink/make_bed/scalepopgen_rem_indi_ld_filtered_update_chrom_id.bim
      md5sum: 90b121614b3d5ed53d8c6bc207328245
    - path: results/plink2/make_bed/scalepopgen_rem_indi_ld_filtered_update_chrom_id.fam
      md5sum: 8176ac7ed0fe0a650aa73de8102b56b5
    - path: results/pca/plink2/export_ped/scalepopgen_rem_indi_ld_filtered_update_chrom_id.map
      md5sum: 5a91cad4a32ea97fe25c4b8901386f56
    - path: results/pca/plink2/export_ped/scalepopgen_rem_indi_ld_filtered_update_chrom_id.ped
      md5sum: 59a1d0b86ab35af1169fdef2e6327ba1
    - path: results/pca/python/create/eigenstrat_par/scalepopgen_rem_indi_ld_filtered_update_chrom_id.ped_to_eigenstraat.par
      md5sum: d2eac557b04f1ec854f407fa912644b8
    - path: results/pca/gawk/modify_pheno_col_ped/scalepopgen_rem_indi_ld_filtered_update_chrom_id.1.ped
      md5sum: 37dd53c07056b4c69b913fc162085e63
    - path: results/pca/eigensoft/convertf/scalepopgen_rem_indi_ld_filtered_update_chrom_id.eigenstratgeno
      md5sum: d02e409aa8bf48a2e62c214f6ebbb3f9
    - path: results/pca/eigensoft/convertf/scalepopgen_rem_indi_ld_filtered_update_chrom_id.ind
      md5sum: cc6ce61a01bf470350d79b84b412175e
    - path: results/pca/eigensoft/convertf/scalepopgen_rem_indi_ld_filtered_update_chrom_id.snp
      md5sum: 934249b774ac3c98f1ca991bc43af639
    - path: results/pca/python/create/smartpca_par/scalepopgen_rem_indi_ld_filtered_update_chrom_id.smartpca.par
      md5sum: b80032184cfd2c8ea2ab37c08e1ad96f
    - path: results/pca/eigensoft/smartpca/scalepopgen_rem_indi_ld_filtered_update_chrom_id.eval
      md5sum: 955d0d44dcdddb9224192564f81f6349
    - path: results/pca/eigensoft/smartpca/scalepopgen_rem_indi_ld_filtered_update_chrom_id.evec
      md5sum: c6b9f0959e3abdf50c7064dc0742de2a
    - path: results/pca/python/plot/pca/scalepopgen_rem_indi_ld_filtered_update_chrom_id_mqc.html

- name: filtering and admixture
  command: nextflow run scalepopgen_v1/ -profile test_filter_admixture,mamba --outdir results
  tags:
    - test_filters_admixture
  files:
    - path: results/admixture/ADMIXTURE/10.log
    - path: results/admixture/ADMIXTURE/11.log
    - path: results/admixture/ADMIXTURE/2.log
    - path: results/admixture/ADMIXTURE/3.log
    - path: results/admixture/ADMIXTURE/4.log
    - path: results/admixture/ADMIXTURE/5.log
    - path: results/admixture/ADMIXTURE/6.log
    - path: results/admixture/ADMIXTURE/7.log
    - path: results/admixture/ADMIXTURE/8.log
    - path: results/admixture/ADMIXTURE/9.log
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.10.P
      md5sum: 543d2d387638515ea31a7bc602011bfe
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.10.Q
      md5sum: 0663b95b3a9df1784855b40c9c27b16f
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.11.P
      md5sum: c205dad8965c2a83e736735bc6a55644
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.11.Q
      md5sum: f46ab9608530860ad6033835ed03773e
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.2.P
      md5sum: 465387085009cdbe4df3bb78a8d94ddc
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.2.Q
      md5sum: b54fe7b494a6332a24b0786023b5e368
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.3.P
      md5sum: 483fb31a0e4a85cf4bae013013b39511
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.3.Q
      md5sum: b32ab859732b63b23c478de1faa0e3ce
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.4.P
      md5sum: 0b57f6d4aa16bc862a40f66913dcc4c6
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.4.Q
      md5sum: 6998ce3223760cfa137e3cd3b3ed699a
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.5.P
      md5sum: 23d51b60520f7be0a47cf4c73f114865
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.5.Q
      md5sum: 3ab73bf252cc03936200598ec9adbfc1
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.6.P
      md5sum: f05e3ea57069754c04c5fd0f4a53e25b
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.6.Q
      md5sum: 075c7bfec15f8ab2cea4f2af4b9c1bab
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.7.P
      md5sum: c2c1e802a7f9867d253cb2a179dc8c7f
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.7.Q
      md5sum: 89cb273df5a88d162f874d71ca0d6ac6
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.8.P
      md5sum: 779568baf6766ad04bfca3a0618e4e6c
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.8.Q
      md5sum: 780a3960b978de3101606368a22a42bf
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.9.P
      md5sum: 02ad848a7777ed2f35cc2f1f48e82890
    - path: results/admixture/ADMIXTURE/scalepopgen_rem_indi_ld_filtered_update_chrom_id.9.Q
      md5sum: f21ac2f13489e87922758dde469ac7b3
    - path: results/admixture/ADMIXTURE/versions.yml
      md5sum: 1f289165d75b809905f64e53d675e2d3
    - path: results/admixture/python/plot/admixture/cv_error/cvplot_mqc.html
    - path: results/admixture/python/plot/admixture/q_mat/scalepopgen_qmats_mqc.html

- name: test_plink_filter_summary_stats
  command: nextflow run ./scalepopgen_v1/ -profile test_plink_filter_summary,mamba --outdir results -resume
  tags:
    - test_p_filter_summary
  files:
    - path: ./results/gawk/make_cluster_file/scalepopgen.cluster
      md5sum: 00c75d5234175ea64dabfa6bb336e80d
    - path: ./results/gawk/make_cluster_file/versions.yml
      md5sum: 831e2dea0fec439f22ab4215734177c0
    - path: ./results/gawk/split_fam_file/Egypt_id.txt
      md5sum: 4f869f4cd0800460d1a495e59d93e7c1
    - path: ./results/gawk/split_fam_file/Spain_id.txt
      md5sum: bc8925bd295ddf2fd05ec00978b9e7b0
    - path: ./results/gawk/split_fam_file/Sudan_id.txt
      md5sum: ec411860a6147a137a4e10ed39c196a1
    - path: ./results/gawk/split_fam_file/Swiss_id.txt
      md5sum: 7e05125bf3ff4833d95d29cc5176c854
    - path: ./results/gawk/split_fam_file/Turkey_id.txt
      md5sum: 0a7076a5385ed9612cf1138fd3553389
    - path: ./results/gawk/split_fam_file/versions.yml
      md5sum: 5ec5ba8298602f344b47dbcbb31c2979
    - path: ./results/multiqc/multiqc_data/multiqc_citations.txt
      md5sum: 4c806e63a283ec1b7e78cdae3a923d4f
    - path: ./results/multiqc/multiqc_data/multiqc_data.json
    - path: ./results/multiqc/multiqc_data/multiqc.log
    - path: ./results/multiqc/multiqc_data/multiqc_sources.txt
      md5sum: d2a044df39ce3c6abe5cdc2d67473490
    - path: ./results/multiqc/multiqc_report.html
      md5sum: 3558c294c81c81f0e530802714d3f8ae
    - path: ./results/pop_sc_color.map
      md5sum: 2a7c668cbfdecce7b99e3088bc754a36
    - path: ./results/sample_filtering/plink2/filter_samples/goat_rem_indi.bed
      md5sum: a9dbaaa94834e60d034f29d547107932
    - path: ./results/sample_filtering/plink2/filter_samples/goat_rem_indi.bim
      md5sum: 8e3b9dcf222930fa4e73ad920903a2f2
    - path: ./results/sample_filtering/plink2/filter_samples/goat_rem_indi.fam
      md5sum: ade2352417990bf6532b6aa0829c0cc8
    - path: ./results/sample_filtering/plink2/filter_samples/goat_rem_indi.king.cutoff.in.id
      md5sum: 381fd30bb6cf7237c9e8d38ebca824bd
    - path: ./results/sample_filtering/plink2/filter_samples/goat_rem_indi.king.cutoff.out.id
      md5sum: 99fbfa3e9d78378565234dc9e46d1529
    - path: ./results/sample_filtering/plink2/filter_samples/goat_rem_indi.log
    - path: ./results/sample_filtering/plink2/filter_samples/goat_rem_indi.mindrem.id
      md5sum: f18f42028b68e2de90c46c96650e042e
    - path: ./results/sample_filtering/plink2/filter_samples/versions.yml
      md5sum: 62286d568bbc2f3cb29112c6ccde1330
    - path: ./results/snp_filtering/plink2/filter_snps/goat_rem_indi_filt_sites.bed
      md5sum: 2e14d41e5cc5ba3c50c8f546529c959f
    - path: ./results/snp_filtering/plink2/filter_snps/goat_rem_indi_filt_sites.bim
      md5sum: fb37fdee0bf72c7a10880517b70bdc91
    - path: ./results/snp_filtering/plink2/filter_snps/goat_rem_indi_filt_sites.fam
      md5sum: ade2352417990bf6532b6aa0829c0cc8
    - path: ./results/snp_filtering/plink2/filter_snps/goat_rem_indi_filt_sites.log
      md5sum: a4ef4be3a04bdb4c5d7c2e099bf63e69
    - path: ./results/snp_filtering/plink2/filter_snps/versions.yml
      md5sum: 35aa01d22edc49e30c6fcae8fd1522b5
    - path: ./results/summary_stats/plink2/sample_counts/goat_rem_indi_filt_sites_sample_summary.scount
      md5sum: cd2200675053eb2ef938e9eba3a9136f
    - path: ./results/summary_stats/plink2/sample_counts/versions.yml
      md5sum: 9271e665839fe8355b3f63cff34d37a9
    - path: ./results/summary_stats/plink/calc_maf_hardy/Egypt_id.hwe
      md5sum: 02d452b18cbf9e6aa3721e8007394bc7
    - path: ./results/summary_stats/plink/calc_maf_hardy/goat_rem_indi_filt_sites.frq.strat
      md5sum: b4024145de87dd2a08d89704efd5da94
    - path: ./results/summary_stats/plink/calc_maf_hardy/Spain_id.hwe
      md5sum: 3d6806e6531dd73e82bc5526f2fb8f32
    - path: ./results/summary_stats/plink/calc_maf_hardy/Sudan_id.hwe
      md5sum: f1feef77070b17ba22ea64356875c6f1
    - path: ./results/summary_stats/plink/calc_maf_hardy/Swiss_id.hwe
      md5sum: 5d66bb8bee269a005e712077a1937a7a
    - path: ./results/summary_stats/plink/calc_maf_hardy/Turkey_id.hwe
      md5sum: 89739c207f0b28e0f7e10db163bc5c6d
    - path: ./results/summary_stats/python/plot/average_het/populationwise_heterozygosity_report.txt
    - path: ./results/summary_stats/python/plot/average_het/scalepopgen_exp_het_mqc.html
    - path: ./results/summary_stats/python/plot/average_het/scalepopgen_obs_het_mqc.html
    - path: ./results/summary_stats/python/plot/average_maf/populationwise_maf_report.txt
      md5sum: a9dc06e82cb9fd9caa52cea2f89119fa
    - path: ./results/summary_stats/python/plot/average_maf/scalepopgen_maf_summary_mqc.html
    - path: ./results/summary_stats/python/plot/sample_stats/scalepopgen_samplewise_snp_counts_mqc.html
    - path: ./results/versions.yml
      md5sum: 0e945272d2372c7d66d6c1e673a8be99
